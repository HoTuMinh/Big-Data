<!DOCTYPE html>
<!-- saved from url=(0097)https://hieundtlu.github.io/tlu/hadoop/2022/04/24/MapReduce-Lap-trinh-chuong-trinh-WordCount.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>MapReduce - Lập trình chương trình WordCount | Phân tích dữ liệu lớn</title>
<meta name="generator" content="Jekyll v3.9.3">
<meta property="og:title" content="MapReduce - Lập trình chương trình WordCount">
<meta property="og:locale" content="en_US">
<meta name="description" content="I. Thử nghiêm với hàm mẫu WordCount của Hadoop Trong thư mục C:\hadoop-3.3.0\share\hadoop\mapreduce Hadoop đã có sẵn chương trình MapReduce hadoop-mapreduce-examples-3.3.0.jar. Ta sẽ thử nghiệm bài toán đếm từ bằng cách tạo ra file text chứa dữ liệu và đầu ra mong muốn là các cặp [từ: số lượng xuất hiện] Bước 1: Tạo file data.txt Nội dung của file data.txt là: Bus Car bus car train car bus car train bus TRAIN BUS buS caR CAR car BUS TRAIN Bước 2: Tạo thư mục input tại hdfs và lưu file data.txt Tạo thư mục input trong hdfs với câu lệnh: hdfs dfs -mkdir /input Đẩy file data.txt vào folder input vừa tạo: hdfs dfs -put &quot;C:\input\data.txt&quot; /input Lưu ý: Thay “C:\input\data.txt” bằng nơi lưu trữ file trong máy Vào trang quản lý NameNode http://localhost:9870/ để kiểm tra file Bước 3: Chạy chương trình MapReduce và xem kết quả Chương trình mẫu MapReduce của Hadoop nằm tại C:\hadoop-3.3.0\share\hadoop\mapreduce\hadoop-mapreduce-examples-3.3.0.jar. Ta sẽ thử nghiệm đầu vào chương trình là file data.txt và kết quả sẽ được lưu tại folder /output, lệnh thực hiện” hadoop jar &quot;C:\hadoop-3.3.0\share\hadoop\mapreduce\hadoop-mapreduce-examples-3.3.0.jar&quot; wordcount /input/data.txt /output Xem kết quả thu được: Hoặc dùng lệnh cmd: hdfs dfs -cat /output/part-r-00000 Lưu ý: thay /output/part-r-00000 thành đường dẫn file muốn xem Như vậy ta đã chạy thành công chương trình mẫu MapReduce của Hadoop cung cấp. II. Lập trình chương trình WordCount bằng Eclipse Bước 1: Tạo project Mở chương trình Eclipse. Chọn workspace (nên để mặc định) Tạo project Java, chọn File &gt; New &gt; Java Project Đặt tên project là WordCount và chọn môi trường là JavaSE-1.8. Xong ấn Finish. Bước 2: Thêm thư viện cần thiết để chạy MapReduce Chuột phải vào project WordCount chọn Properties Chọn Java Build Path, chọn tab Libraries và bấm Add External JARs Chọn tất cả file trong thư mục C:\hadoop-3.3.0\share\hadoop\client và ấn Open Tương tự chọn tất cả file trong thư mục C:\hadoop-3.3.0\share\hadoop\common và ấn Open Chọn tất cả file trong thư mục C:\hadoop-3.3.0\share\hadoop\common\lib và ấn Open Chọn tất cả file trong thư mục C:\hadoop-3.3.0\share\hadoop\hdfs và ấn Open Chọn tất cả file trong thư mục C:\hadoop-3.3.0\share\hadoop\mapreduce và ấn Open Chọn tất cả file trong thư mục C:\hadoop-3.3.0\share\hadoop\yarn và ấn Open Ấn Apply and Close Bước 3: Tạo class xử lý tác vụ MapReduce Double click vào project WordCount, chuột phải vào src và chọn New &gt; Class Tạo class để xử lý nhiệm vụ Map, đặt tên là WordCountMapper Nội dung bên trong file WordCountMapper.java: import java.io.IOException; import java.util.StringTokenizer; import org.apache.hadoop.io.IntWritable; import org.apache.hadoop.io.Text; import org.apache.hadoop.mapreduce.Mapper; import org.apache.hadoop.io.LongWritable; public class WordCountMapper extends Mapper &lt;LongWritable, Text, Text, IntWritable&gt; { private Text wordToken = new Text(); public void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException { StringTokenizer tokens = new StringTokenizer(value.toString()); //Dividing String into tokens while (tokens.hasMoreTokens()) { wordToken.set(tokens.nextToken()); context.write(wordToken, new IntWritable(1)); } } } Tương tự tạo class xử lý nhiệm vụ Reduce, đặt tên là WordCountReducer: import java.io.IOException; import org.apache.hadoop.io.IntWritable; import org.apache.hadoop.io.Text; import org.apache.hadoop.mapreduce.Reducer; public class WordCountReducer extends Reducer &lt;Text, IntWritable, Text, IntWritable&gt; { private IntWritable count = new IntWritable(); public void reduce(Text key, Iterable&lt;IntWritable&gt; values, Context context) throws IOException, InterruptedException { int valueSum = 0; for (IntWritable val : values) { valueSum += val.get(); } count.set(valueSum); context.write(key, count); } } Và tạo class WordCount chứa hàm main để khởi chạy chương trình: import org.apache.hadoop.conf.Configuration; import org.apache.hadoop.fs.Path; import org.apache.hadoop.io.IntWritable; import org.apache.hadoop.io.Text; import org.apache.hadoop.mapreduce.Job; import org.apache.hadoop.mapreduce.lib.input.FileInputFormat; import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat; import org.apache.hadoop.util.GenericOptionsParser; public class WordCount { public static void main(String[] args) throws Exception { Configuration conf = new Configuration(); String[] pathArgs = new GenericOptionsParser(conf, args).getRemainingArgs(); if (pathArgs.length &lt; 2) { System.err.println(&quot;MR Project Usage: wordcount &lt;input-path&gt; [...] &lt;output-path&gt;&quot;); System.exit(2); } Job wcJob = Job.getInstance(conf, &quot;MapReduce WordCount&quot;); wcJob.setJarByClass(WordCount.class); wcJob.setMapperClass(WordCountMapper.class); wcJob.setCombinerClass(WordCountReducer.class); wcJob.setReducerClass(WordCountReducer.class); wcJob.setOutputKeyClass(Text.class); wcJob.setOutputValueClass(IntWritable.class); for (int i = 0; i &lt; pathArgs.length - 1; ++i) { FileInputFormat.addInputPath(wcJob, new Path(pathArgs[i])); } FileOutputFormat.setOutputPath(wcJob, new Path(pathArgs[pathArgs.length - 1])); System.exit(wcJob.waitForCompletion(true) ? 0 : 1); } } Bước 4: Tạo file JAR Chuột phải vào project WordCount chọn Export Chọn Java &gt; JAR File rồi bấm Next Chọn đường dẫn lưu file JAR và bấm Next Bấm Next Bấm Browser để chọn file main Chọn WordCount và bấm OK Bấm Finish để thực hiện quá trình Export Vào thư mục chứa lưu file JAR vừa tạo và kiểm tra kết quả Thử nghiệm trên file dữ liệu data.txt đã tạo ở trên, và kết quả thu được lưu tại thư mục r_output. Chạy lệnh sau: hadoop jar &quot;C:\jar\WordCount.jar&quot; /input/data.txt /r_output Lưu ý: Thay “C:\jar\WordCount.jar” bằng đường dẫn chứa file JAR ở trên máy">
<meta property="og:description" content="I. Thử nghiêm với hàm mẫu WordCount của Hadoop Trong thư mục C:\hadoop-3.3.0\share\hadoop\mapreduce Hadoop đã có sẵn chương trình MapReduce hadoop-mapreduce-examples-3.3.0.jar. Ta sẽ thử nghiệm bài toán đếm từ bằng cách tạo ra file text chứa dữ liệu và đầu ra mong muốn là các cặp [từ: số lượng xuất hiện] Bước 1: Tạo file data.txt Nội dung của file data.txt là: Bus Car bus car train car bus car train bus TRAIN BUS buS caR CAR car BUS TRAIN Bước 2: Tạo thư mục input tại hdfs và lưu file data.txt Tạo thư mục input trong hdfs với câu lệnh: hdfs dfs -mkdir /input Đẩy file data.txt vào folder input vừa tạo: hdfs dfs -put &quot;C:\input\data.txt&quot; /input Lưu ý: Thay “C:\input\data.txt” bằng nơi lưu trữ file trong máy Vào trang quản lý NameNode http://localhost:9870/ để kiểm tra file Bước 3: Chạy chương trình MapReduce và xem kết quả Chương trình mẫu MapReduce của Hadoop nằm tại C:\hadoop-3.3.0\share\hadoop\mapreduce\hadoop-mapreduce-examples-3.3.0.jar. Ta sẽ thử nghiệm đầu vào chương trình là file data.txt và kết quả sẽ được lưu tại folder /output, lệnh thực hiện” hadoop jar &quot;C:\hadoop-3.3.0\share\hadoop\mapreduce\hadoop-mapreduce-examples-3.3.0.jar&quot; wordcount /input/data.txt /output Xem kết quả thu được: Hoặc dùng lệnh cmd: hdfs dfs -cat /output/part-r-00000 Lưu ý: thay /output/part-r-00000 thành đường dẫn file muốn xem Như vậy ta đã chạy thành công chương trình mẫu MapReduce của Hadoop cung cấp. II. Lập trình chương trình WordCount bằng Eclipse Bước 1: Tạo project Mở chương trình Eclipse. Chọn workspace (nên để mặc định) Tạo project Java, chọn File &gt; New &gt; Java Project Đặt tên project là WordCount và chọn môi trường là JavaSE-1.8. Xong ấn Finish. Bước 2: Thêm thư viện cần thiết để chạy MapReduce Chuột phải vào project WordCount chọn Properties Chọn Java Build Path, chọn tab Libraries và bấm Add External JARs Chọn tất cả file trong thư mục C:\hadoop-3.3.0\share\hadoop\client và ấn Open Tương tự chọn tất cả file trong thư mục C:\hadoop-3.3.0\share\hadoop\common và ấn Open Chọn tất cả file trong thư mục C:\hadoop-3.3.0\share\hadoop\common\lib và ấn Open Chọn tất cả file trong thư mục C:\hadoop-3.3.0\share\hadoop\hdfs và ấn Open Chọn tất cả file trong thư mục C:\hadoop-3.3.0\share\hadoop\mapreduce và ấn Open Chọn tất cả file trong thư mục C:\hadoop-3.3.0\share\hadoop\yarn và ấn Open Ấn Apply and Close Bước 3: Tạo class xử lý tác vụ MapReduce Double click vào project WordCount, chuột phải vào src và chọn New &gt; Class Tạo class để xử lý nhiệm vụ Map, đặt tên là WordCountMapper Nội dung bên trong file WordCountMapper.java: import java.io.IOException; import java.util.StringTokenizer; import org.apache.hadoop.io.IntWritable; import org.apache.hadoop.io.Text; import org.apache.hadoop.mapreduce.Mapper; import org.apache.hadoop.io.LongWritable; public class WordCountMapper extends Mapper &lt;LongWritable, Text, Text, IntWritable&gt; { private Text wordToken = new Text(); public void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException { StringTokenizer tokens = new StringTokenizer(value.toString()); //Dividing String into tokens while (tokens.hasMoreTokens()) { wordToken.set(tokens.nextToken()); context.write(wordToken, new IntWritable(1)); } } } Tương tự tạo class xử lý nhiệm vụ Reduce, đặt tên là WordCountReducer: import java.io.IOException; import org.apache.hadoop.io.IntWritable; import org.apache.hadoop.io.Text; import org.apache.hadoop.mapreduce.Reducer; public class WordCountReducer extends Reducer &lt;Text, IntWritable, Text, IntWritable&gt; { private IntWritable count = new IntWritable(); public void reduce(Text key, Iterable&lt;IntWritable&gt; values, Context context) throws IOException, InterruptedException { int valueSum = 0; for (IntWritable val : values) { valueSum += val.get(); } count.set(valueSum); context.write(key, count); } } Và tạo class WordCount chứa hàm main để khởi chạy chương trình: import org.apache.hadoop.conf.Configuration; import org.apache.hadoop.fs.Path; import org.apache.hadoop.io.IntWritable; import org.apache.hadoop.io.Text; import org.apache.hadoop.mapreduce.Job; import org.apache.hadoop.mapreduce.lib.input.FileInputFormat; import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat; import org.apache.hadoop.util.GenericOptionsParser; public class WordCount { public static void main(String[] args) throws Exception { Configuration conf = new Configuration(); String[] pathArgs = new GenericOptionsParser(conf, args).getRemainingArgs(); if (pathArgs.length &lt; 2) { System.err.println(&quot;MR Project Usage: wordcount &lt;input-path&gt; [...] &lt;output-path&gt;&quot;); System.exit(2); } Job wcJob = Job.getInstance(conf, &quot;MapReduce WordCount&quot;); wcJob.setJarByClass(WordCount.class); wcJob.setMapperClass(WordCountMapper.class); wcJob.setCombinerClass(WordCountReducer.class); wcJob.setReducerClass(WordCountReducer.class); wcJob.setOutputKeyClass(Text.class); wcJob.setOutputValueClass(IntWritable.class); for (int i = 0; i &lt; pathArgs.length - 1; ++i) { FileInputFormat.addInputPath(wcJob, new Path(pathArgs[i])); } FileOutputFormat.setOutputPath(wcJob, new Path(pathArgs[pathArgs.length - 1])); System.exit(wcJob.waitForCompletion(true) ? 0 : 1); } } Bước 4: Tạo file JAR Chuột phải vào project WordCount chọn Export Chọn Java &gt; JAR File rồi bấm Next Chọn đường dẫn lưu file JAR và bấm Next Bấm Next Bấm Browser để chọn file main Chọn WordCount và bấm OK Bấm Finish để thực hiện quá trình Export Vào thư mục chứa lưu file JAR vừa tạo và kiểm tra kết quả Thử nghiệm trên file dữ liệu data.txt đã tạo ở trên, và kết quả thu được lưu tại thư mục r_output. Chạy lệnh sau: hadoop jar &quot;C:\jar\WordCount.jar&quot; /input/data.txt /r_output Lưu ý: Thay “C:\jar\WordCount.jar” bằng đường dẫn chứa file JAR ở trên máy">
<link rel="canonical" href="https://hieundtlu.github.io/tlu/hadoop/2022/04/24/MapReduce-Lap-trinh-chuong-trinh-WordCount.html">
<meta property="og:url" content="https://hieundtlu.github.io/tlu/hadoop/2022/04/24/MapReduce-Lap-trinh-chuong-trinh-WordCount.html">
<meta property="og:site_name" content="Phân tích dữ liệu lớn">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2022-04-24T00:00:00+00:00">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="MapReduce - Lập trình chương trình WordCount">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-04-24T00:00:00+00:00","datePublished":"2022-04-24T00:00:00+00:00","description":"I. Thử nghiêm với hàm mẫu WordCount của Hadoop Trong thư mục C:\\hadoop-3.3.0\\share\\hadoop\\mapreduce Hadoop đã có sẵn chương trình MapReduce hadoop-mapreduce-examples-3.3.0.jar. Ta sẽ thử nghiệm bài toán đếm từ bằng cách tạo ra file text chứa dữ liệu và đầu ra mong muốn là các cặp [từ: số lượng xuất hiện] Bước 1: Tạo file data.txt Nội dung của file data.txt là: Bus Car bus car train car bus car train bus TRAIN BUS buS caR CAR car BUS TRAIN Bước 2: Tạo thư mục input tại hdfs và lưu file data.txt Tạo thư mục input trong hdfs với câu lệnh: hdfs dfs -mkdir /input Đẩy file data.txt vào folder input vừa tạo: hdfs dfs -put &quot;C:\\input\\data.txt&quot; /input Lưu ý: Thay “C:\\input\\data.txt” bằng nơi lưu trữ file trong máy Vào trang quản lý NameNode http://localhost:9870/ để kiểm tra file Bước 3: Chạy chương trình MapReduce và xem kết quả Chương trình mẫu MapReduce của Hadoop nằm tại C:\\hadoop-3.3.0\\share\\hadoop\\mapreduce\\hadoop-mapreduce-examples-3.3.0.jar. Ta sẽ thử nghiệm đầu vào chương trình là file data.txt và kết quả sẽ được lưu tại folder /output, lệnh thực hiện” hadoop jar &quot;C:\\hadoop-3.3.0\\share\\hadoop\\mapreduce\\hadoop-mapreduce-examples-3.3.0.jar&quot; wordcount /input/data.txt /output Xem kết quả thu được: Hoặc dùng lệnh cmd: hdfs dfs -cat /output/part-r-00000 Lưu ý: thay /output/part-r-00000 thành đường dẫn file muốn xem Như vậy ta đã chạy thành công chương trình mẫu MapReduce của Hadoop cung cấp. II. Lập trình chương trình WordCount bằng Eclipse Bước 1: Tạo project Mở chương trình Eclipse. Chọn workspace (nên để mặc định) Tạo project Java, chọn File &gt; New &gt; Java Project Đặt tên project là WordCount và chọn môi trường là JavaSE-1.8. Xong ấn Finish. Bước 2: Thêm thư viện cần thiết để chạy MapReduce Chuột phải vào project WordCount chọn Properties Chọn Java Build Path, chọn tab Libraries và bấm Add External JARs Chọn tất cả file trong thư mục C:\\hadoop-3.3.0\\share\\hadoop\\client và ấn Open Tương tự chọn tất cả file trong thư mục C:\\hadoop-3.3.0\\share\\hadoop\\common và ấn Open Chọn tất cả file trong thư mục C:\\hadoop-3.3.0\\share\\hadoop\\common\\lib và ấn Open Chọn tất cả file trong thư mục C:\\hadoop-3.3.0\\share\\hadoop\\hdfs và ấn Open Chọn tất cả file trong thư mục C:\\hadoop-3.3.0\\share\\hadoop\\mapreduce và ấn Open Chọn tất cả file trong thư mục C:\\hadoop-3.3.0\\share\\hadoop\\yarn và ấn Open Ấn Apply and Close Bước 3: Tạo class xử lý tác vụ MapReduce Double click vào project WordCount, chuột phải vào src và chọn New &gt; Class Tạo class để xử lý nhiệm vụ Map, đặt tên là WordCountMapper Nội dung bên trong file WordCountMapper.java: import java.io.IOException; import java.util.StringTokenizer; import org.apache.hadoop.io.IntWritable; import org.apache.hadoop.io.Text; import org.apache.hadoop.mapreduce.Mapper; import org.apache.hadoop.io.LongWritable; public class WordCountMapper extends Mapper &lt;LongWritable, Text, Text, IntWritable&gt; { private Text wordToken = new Text(); public void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException { StringTokenizer tokens = new StringTokenizer(value.toString()); //Dividing String into tokens while (tokens.hasMoreTokens()) { wordToken.set(tokens.nextToken()); context.write(wordToken, new IntWritable(1)); } } } Tương tự tạo class xử lý nhiệm vụ Reduce, đặt tên là WordCountReducer: import java.io.IOException; import org.apache.hadoop.io.IntWritable; import org.apache.hadoop.io.Text; import org.apache.hadoop.mapreduce.Reducer; public class WordCountReducer extends Reducer &lt;Text, IntWritable, Text, IntWritable&gt; { private IntWritable count = new IntWritable(); public void reduce(Text key, Iterable&lt;IntWritable&gt; values, Context context) throws IOException, InterruptedException { int valueSum = 0; for (IntWritable val : values) { valueSum += val.get(); } count.set(valueSum); context.write(key, count); } } Và tạo class WordCount chứa hàm main để khởi chạy chương trình: import org.apache.hadoop.conf.Configuration; import org.apache.hadoop.fs.Path; import org.apache.hadoop.io.IntWritable; import org.apache.hadoop.io.Text; import org.apache.hadoop.mapreduce.Job; import org.apache.hadoop.mapreduce.lib.input.FileInputFormat; import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat; import org.apache.hadoop.util.GenericOptionsParser; public class WordCount { public static void main(String[] args) throws Exception { Configuration conf = new Configuration(); String[] pathArgs = new GenericOptionsParser(conf, args).getRemainingArgs(); if (pathArgs.length &lt; 2) { System.err.println(&quot;MR Project Usage: wordcount &lt;input-path&gt; [...] &lt;output-path&gt;&quot;); System.exit(2); } Job wcJob = Job.getInstance(conf, &quot;MapReduce WordCount&quot;); wcJob.setJarByClass(WordCount.class); wcJob.setMapperClass(WordCountMapper.class); wcJob.setCombinerClass(WordCountReducer.class); wcJob.setReducerClass(WordCountReducer.class); wcJob.setOutputKeyClass(Text.class); wcJob.setOutputValueClass(IntWritable.class); for (int i = 0; i &lt; pathArgs.length - 1; ++i) { FileInputFormat.addInputPath(wcJob, new Path(pathArgs[i])); } FileOutputFormat.setOutputPath(wcJob, new Path(pathArgs[pathArgs.length - 1])); System.exit(wcJob.waitForCompletion(true) ? 0 : 1); } } Bước 4: Tạo file JAR Chuột phải vào project WordCount chọn Export Chọn Java &gt; JAR File rồi bấm Next Chọn đường dẫn lưu file JAR và bấm Next Bấm Next Bấm Browser để chọn file main Chọn WordCount và bấm OK Bấm Finish để thực hiện quá trình Export Vào thư mục chứa lưu file JAR vừa tạo và kiểm tra kết quả Thử nghiệm trên file dữ liệu data.txt đã tạo ở trên, và kết quả thu được lưu tại thư mục r_output. Chạy lệnh sau: hadoop jar &quot;C:\\jar\\WordCount.jar&quot; /input/data.txt /r_output Lưu ý: Thay “C:\\jar\\WordCount.jar” bằng đường dẫn chứa file JAR ở trên máy","headline":"MapReduce - Lập trình chương trình WordCount","mainEntityOfPage":{"@type":"WebPage","@id":"https://hieundtlu.github.io/tlu/hadoop/2022/04/24/MapReduce-Lap-trinh-chuong-trinh-WordCount.html"},"url":"https://hieundtlu.github.io/tlu/hadoop/2022/04/24/MapReduce-Lap-trinh-chuong-trinh-WordCount.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/style.css"><link type="application/atom+xml" rel="alternate" href="https://hieundtlu.github.io/tlu/feed.xml" title="Phân tích dữ liệu lớn">
<link type="text/css" rel="stylesheet" href="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/css2"></head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="https://hieundtlu.github.io/tlu/">Phân tích dữ liệu lớn</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger">
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="https://hieundtlu.github.io/tlu/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope="" itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">MapReduce - Lập trình chương trình WordCount</h1>
    <p class="post-meta"><time class="dt-published" datetime="2022-04-24T00:00:00+00:00" itemprop="datePublished">
        Apr 24, 2022
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h2 id="i-thử-nghiêm-với-hàm-mẫu-wordcount-của-hadoop">I. Thử nghiêm với hàm mẫu WordCount của Hadoop</h2>

<p>Trong thư mục <strong>C:\hadoop-3.3.0\share\hadoop\mapreduce</strong> Hadoop đã có sẵn chương trình MapReduce <strong>hadoop-mapreduce-examples-3.3.0.jar</strong>. Ta sẽ thử nghiệm bài toán đếm từ bằng cách tạo ra file text chứa dữ liệu và đầu ra mong muốn là các cặp <strong>[từ: số lượng xuất hiện]</strong></p>

<h3 id="bước-1-tạo-file-datatxt">Bước 1: Tạo file data.txt</h3>

<p>Nội dung của file data.txt là:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Bus Car bus
car train car
bus car train
bus TRAIN BUS
buS caR CAR
car BUS TRAIN
</code></pre></div></div>

<h3 id="bước-2-tạo-thư-mục-input-tại-hdfs-và-lưu-file-datatxt">Bước 2: Tạo thư mục input tại hdfs và lưu file data.txt</h3>

<p>Tạo thư mục <strong>input</strong> trong hdfs với câu lệnh:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hdfs dfs -mkdir /input
</code></pre></div></div>

<p>Đẩy file <strong>data.txt</strong> vào folder <strong>input</strong> vừa tạo:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hdfs dfs -put "C:\input\data.txt" /input
</code></pre></div></div>

<blockquote>
  <p>Lưu ý: Thay “C:\input\data.txt” bằng nơi lưu trữ file trong máy</p>
</blockquote>

<p>Vào trang quản lý NameNode <a href="http://localhost:9870/">http://localhost:9870/</a> để kiểm tra file</p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/browser-file-hdfs.png" alt="MapReduce"></p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/folder-input-created.png" alt="MapReduce"></p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/data-saved.png" alt="MapReduce"></p>

<h3 id="bước-3-chạy-chương-trình-mapreduce-và-xem-kết-quả">Bước 3: Chạy chương trình MapReduce và xem kết quả</h3>

<p>Chương trình mẫu MapReduce của Hadoop nằm tại <strong>C:\hadoop-3.3.0\share\hadoop\mapreduce\hadoop-mapreduce-examples-3.3.0.jar</strong>. Ta sẽ thử nghiệm đầu vào chương trình là file <strong>data.txt</strong> và kết quả sẽ được lưu tại folder <strong>/output</strong>, lệnh thực hiện”</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hadoop jar "C:\hadoop-3.3.0\share\hadoop\mapreduce\hadoop-mapreduce-examples-3.3.0.jar" wordcount /input/data.txt /output
</code></pre></div></div>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/run-sample-mapreduce.png" alt="MapReduce"></p>

<p>Xem kết quả thu được:</p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/show-result-mr.png" alt="MapReduce"></p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/show-result-mr2.png" alt="MapReduce"></p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/show-result-mr3.png" alt="MapReduce"></p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/show-result-mr4.png" alt="MapReduce"></p>

<p>Hoặc dùng lệnh cmd:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hdfs dfs -cat /output/part-r-00000
</code></pre></div></div>

<blockquote>
  <p>Lưu ý: thay /output/part-r-00000 thành đường dẫn file muốn xem</p>
</blockquote>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/show-result-mr5.png" alt="MapReduce"></p>

<p>Như vậy ta đã chạy thành công chương trình mẫu MapReduce của Hadoop cung cấp.</p>

<h2 id="ii-lập-trình-chương-trình-wordcount-bằng-eclipse">II. Lập trình chương trình WordCount bằng Eclipse</h2>
<h3 id="bước-1-tạo-project">Bước 1: Tạo project</h3>

<p>Mở chương trình Eclipse. Chọn <strong>workspace</strong> (nên để mặc định)</p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/create-wordcount-eclipse.png" alt="MapReduce"></p>

<p>Tạo project Java, chọn <strong>File &gt; New &gt; Java Project</strong></p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/create-wordcount-eclipse2.png" alt="MapReduce"></p>

<p>Đặt tên project là <strong>WordCount</strong> và chọn môi trường là <strong>JavaSE-1.8</strong>. Xong ấn <strong>Finish</strong>.</p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/create-wordcount-eclipse3.png" alt="MapReduce"></p>

<h3 id="bước-2-thêm-thư-viện-cần-thiết-để-chạy-mapreduce">Bước 2: Thêm thư viện cần thiết để chạy MapReduce</h3>

<p>Chuột phải vào project <strong>WordCount</strong> chọn <strong>Properties</strong></p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/add-lib-mr.png" alt="MapReduce"></p>

<p>Chọn <strong>Java Build Path</strong>, chọn tab <strong>Libraries</strong> và bấm <strong>Add External JARs</strong></p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/add-lib-mr2.png" alt="MapReduce"></p>

<p>Chọn tất cả file trong thư mục <strong>C:\hadoop-3.3.0\share\hadoop\client</strong> và ấn <strong>Open</strong></p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/add-lib-mr3.png" alt="MapReduce"></p>

<p>Tương tự chọn tất cả file trong thư mục <strong>C:\hadoop-3.3.0\share\hadoop\common</strong> và ấn <strong>Open</strong></p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/add-lib-mr4.png" alt="MapReduce"></p>

<p>Chọn tất cả file trong thư mục <strong>C:\hadoop-3.3.0\share\hadoop\common\lib</strong> và ấn <strong>Open</strong></p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/add-lib-mr5.png" alt="MapReduce"></p>

<p>Chọn tất cả file trong thư mục <strong>C:\hadoop-3.3.0\share\hadoop\hdfs</strong> và ấn <strong>Open</strong></p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/add-lib-mr6.png" alt="MapReduce"></p>

<p>Chọn tất cả file trong thư mục <strong>C:\hadoop-3.3.0\share\hadoop\mapreduce</strong> và ấn <strong>Open</strong></p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/add-lib-mr7.png" alt="MapReduce"></p>

<p>Chọn tất cả file trong thư mục <strong>C:\hadoop-3.3.0\share\hadoop\yarn</strong> và ấn <strong>Open</strong></p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/add-lib-mr8.png" alt="MapReduce"></p>

<p>Ấn <strong>Apply and Close</strong></p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/add-lib-mr9.png" alt="MapReduce"></p>

<h3 id="bước-3-tạo-class-xử-lý-tác-vụ-mapreduce">Bước 3: Tạo class xử lý tác vụ MapReduce</h3>

<p>Double click vào project <strong>WordCount</strong>, chuột phải vào <strong>src</strong> và chọn <strong>New &gt; Class</strong></p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/create-class-mr.png" alt="MapReduce"></p>

<p>Tạo class để xử lý nhiệm vụ <strong>Map</strong>, đặt tên là <strong>WordCountMapper</strong></p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/create-class-mr2.png" alt="MapReduce"></p>

<p>Nội dung bên trong file <strong>WordCountMapper.java</strong>:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.StringTokenizer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.hadoop.io.IntWritable</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.hadoop.io.Text</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.hadoop.mapreduce.Mapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.hadoop.io.LongWritable</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WordCountMapper</span> <span class="kd">extends</span> <span class="nc">Mapper</span> <span class="o">&lt;</span><span class="nc">LongWritable</span><span class="o">,</span> <span class="nc">Text</span><span class="o">,</span> <span class="nc">Text</span><span class="o">,</span> <span class="nc">IntWritable</span><span class="o">&gt;</span>
<span class="o">{</span>
  <span class="kd">private</span> <span class="nc">Text</span> <span class="n">wordToken</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Text</span><span class="o">();</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">map</span><span class="o">(</span><span class="nc">LongWritable</span> <span class="n">key</span><span class="o">,</span> <span class="nc">Text</span> <span class="n">value</span><span class="o">,</span> <span class="nc">Context</span> <span class="n">context</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span><span class="o">,</span> <span class="nc">InterruptedException</span>
  <span class="o">{</span>
    <span class="nc">StringTokenizer</span> <span class="n">tokens</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringTokenizer</span><span class="o">(</span><span class="n">value</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span> <span class="c1">//Dividing String into tokens</span>
    <span class="k">while</span> <span class="o">(</span><span class="n">tokens</span><span class="o">.</span><span class="na">hasMoreTokens</span><span class="o">())</span>
    <span class="o">{</span>
      <span class="n">wordToken</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">tokens</span><span class="o">.</span><span class="na">nextToken</span><span class="o">());</span>
      <span class="n">context</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">wordToken</span><span class="o">,</span> <span class="k">new</span> <span class="nc">IntWritable</span><span class="o">(</span><span class="mi">1</span><span class="o">));</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Tương tự tạo class xử lý nhiệm vụ <strong>Reduce</strong>, đặt tên là <strong>WordCountReducer</strong>:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.hadoop.io.IntWritable</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.hadoop.io.Text</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.hadoop.mapreduce.Reducer</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WordCountReducer</span> <span class="kd">extends</span> <span class="nc">Reducer</span> <span class="o">&lt;</span><span class="nc">Text</span><span class="o">,</span> <span class="nc">IntWritable</span><span class="o">,</span> <span class="nc">Text</span><span class="o">,</span> <span class="nc">IntWritable</span><span class="o">&gt;</span>
<span class="o">{</span>
  <span class="kd">private</span> <span class="nc">IntWritable</span> <span class="n">count</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">IntWritable</span><span class="o">();</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">reduce</span><span class="o">(</span><span class="nc">Text</span> <span class="n">key</span><span class="o">,</span> <span class="nc">Iterable</span><span class="o">&lt;</span><span class="nc">IntWritable</span><span class="o">&gt;</span> <span class="n">values</span><span class="o">,</span> <span class="nc">Context</span> <span class="n">context</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span><span class="o">,</span> <span class="nc">InterruptedException</span>
  <span class="o">{</span>
    <span class="kt">int</span> <span class="n">valueSum</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="k">for</span> <span class="o">(</span><span class="nc">IntWritable</span> <span class="n">val</span> <span class="o">:</span> <span class="n">values</span><span class="o">)</span>
    <span class="o">{</span>
      <span class="n">valueSum</span> <span class="o">+=</span> <span class="n">val</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="n">count</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">valueSum</span><span class="o">);</span>
    <span class="n">context</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">count</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Và tạo class <strong>WordCount</strong> chứa hàm <strong>main</strong> để khởi chạy chương trình:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">org.apache.hadoop.conf.Configuration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.hadoop.fs.Path</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.hadoop.io.IntWritable</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.hadoop.io.Text</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.hadoop.mapreduce.Job</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.hadoop.mapreduce.lib.input.FileInputFormat</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.hadoop.mapreduce.lib.output.FileOutputFormat</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.hadoop.util.GenericOptionsParser</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">WordCount</span>
<span class="o">{</span>
  <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span>
  <span class="o">{</span>
    <span class="nc">Configuration</span> <span class="n">conf</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Configuration</span><span class="o">();</span>
    <span class="nc">String</span><span class="o">[]</span> <span class="n">pathArgs</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">GenericOptionsParser</span><span class="o">(</span><span class="n">conf</span><span class="o">,</span> <span class="n">args</span><span class="o">).</span><span class="na">getRemainingArgs</span><span class="o">();</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">pathArgs</span><span class="o">.</span><span class="na">length</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="o">)</span>
    <span class="o">{</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">err</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"MR Project Usage: wordcount &lt;input-path&gt; [...] &lt;output-path&gt;"</span><span class="o">);</span>
      <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="mi">2</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="nc">Job</span> <span class="n">wcJob</span> <span class="o">=</span> <span class="nc">Job</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="n">conf</span><span class="o">,</span> <span class="s">"MapReduce WordCount"</span><span class="o">);</span>
    <span class="n">wcJob</span><span class="o">.</span><span class="na">setJarByClass</span><span class="o">(</span><span class="nc">WordCount</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="n">wcJob</span><span class="o">.</span><span class="na">setMapperClass</span><span class="o">(</span><span class="nc">WordCountMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="n">wcJob</span><span class="o">.</span><span class="na">setCombinerClass</span><span class="o">(</span><span class="nc">WordCountReducer</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="n">wcJob</span><span class="o">.</span><span class="na">setReducerClass</span><span class="o">(</span><span class="nc">WordCountReducer</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="n">wcJob</span><span class="o">.</span><span class="na">setOutputKeyClass</span><span class="o">(</span><span class="nc">Text</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="n">wcJob</span><span class="o">.</span><span class="na">setOutputValueClass</span><span class="o">(</span><span class="nc">IntWritable</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">pathArgs</span><span class="o">.</span><span class="na">length</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span> <span class="o">++</span><span class="n">i</span><span class="o">)</span>
    <span class="o">{</span>
      <span class="nc">FileInputFormat</span><span class="o">.</span><span class="na">addInputPath</span><span class="o">(</span><span class="n">wcJob</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Path</span><span class="o">(</span><span class="n">pathArgs</span><span class="o">[</span><span class="n">i</span><span class="o">]));</span>
    <span class="o">}</span>
    <span class="nc">FileOutputFormat</span><span class="o">.</span><span class="na">setOutputPath</span><span class="o">(</span><span class="n">wcJob</span><span class="o">,</span> <span class="k">new</span> <span class="nc">Path</span><span class="o">(</span><span class="n">pathArgs</span><span class="o">[</span><span class="n">pathArgs</span><span class="o">.</span><span class="na">length</span> <span class="o">-</span> <span class="mi">1</span><span class="o">]));</span>
    <span class="nc">System</span><span class="o">.</span><span class="na">exit</span><span class="o">(</span><span class="n">wcJob</span><span class="o">.</span><span class="na">waitForCompletion</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">?</span> <span class="mi">0</span> <span class="o">:</span> <span class="mi">1</span><span class="o">);</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/create-class-mr3.png" alt="MapReduce"></p>

<h3 id="bước-4-tạo-file-jar">Bước 4: Tạo file JAR</h3>

<p>Chuột phải vào project <strong>WordCount</strong> chọn <strong>Export</strong></p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/build-jar-mr.png" alt="MapReduce"></p>

<p>Chọn <strong>Java &gt; JAR File</strong> rồi bấm <strong>Next</strong></p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/build-jar-mr2.png" alt="MapReduce"></p>

<p>Chọn đường dẫn lưu file JAR và bấm <strong>Next</strong></p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/build-jar-mr3.png" alt="MapReduce"></p>

<p>Bấm <strong>Next</strong></p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/build-jar-mr4.png" alt="MapReduce"></p>

<p>Bấm <strong>Browser</strong> để chọn file <strong>main</strong></p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/build-jar-mr5.png" alt="MapReduce"></p>

<p>Chọn <strong>WordCount</strong> và bấm <strong>OK</strong></p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/build-jar-mr6.png" alt="MapReduce"></p>

<p>Bấm <strong>Finish</strong> để thực hiện quá trình <strong>Export</strong></p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/build-jar-mr7.png" alt="MapReduce"></p>

<p>Vào thư mục chứa lưu file JAR vừa tạo và kiểm tra kết quả</p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/build-jar-mr8.png" alt="MapReduce"></p>

<p>Thử nghiệm trên file dữ liệu <strong>data.txt</strong> đã tạo ở trên, và kết quả thu được lưu tại thư mục <strong>r_output</strong>. Chạy lệnh sau:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hadoop jar "C:\jar\WordCount.jar" /input/data.txt /r_output
</code></pre></div></div>
<blockquote>
  <p>Lưu ý: Thay “C:\jar\WordCount.jar” bằng đường dẫn chứa file JAR ở trên máy</p>
</blockquote>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/run-own-mapreduce.png" alt="MapReduce"></p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/result-own-mr.png" alt="MapReduce"></p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/result-own-mr2.png" alt="MapReduce"></p>

<p><img src="./MapReduce - Lập trình chương trình WordCount _ Phân tích dữ liệu lớn_files/result-own-mr3.png" alt="MapReduce"></p>

  </div><a class="u-url" href="https://hieundtlu.github.io/tlu/hadoop/2022/04/24/MapReduce-Lap-trinh-chuong-trinh-WordCount.html" hidden=""></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/tlu/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <!-- <p class="feed-subscribe">
          <a href="/tlu/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/tlu/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p> -->
      </div>
      <div class="footer-col">
        <p></p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>



<span id="PING_CONTENT_DLS_POPUP" style="display: none;"></span><div style="background-color: transparent; border: none; bottom: 15px; display: block; margin: 0px; opacity: 1; padding: 0px; position: fixed; right: 15px; z-index: 2147483647;"><template shadowrootmode="closed"><style>/*!
 * 
 *     MCAFEE RESTRICTED CONFIDENTIAL
 *     Copyright (c) 2024 McAfee, LLC
 *
 *     The source code contained or described herein and all documents related
 *     to the source code ("Material") are owned by McAfee or its
 *     suppliers or licensors. Title to the Material remains with McAfee
 *     or its suppliers and licensors. The Material contains trade
 *     secrets and proprietary and confidential information of McAfee or its
 *     suppliers and licensors. The Material is protected by worldwide copyright
 *     and trade secret laws and treaty provisions. No part of the Material may
 *     be used, copied, reproduced, modified, published, uploaded, posted,
 *     transmitted, distributed, or disclosed in any way without McAfee's prior
 *     express written permission.
 *
 *     No license under any patent, copyright, trade secret or other intellectual
 *     property right is granted to or conferred upon you by disclosure or
 *     delivery of the Materials, either expressly, by implication, inducement,
 *     estoppel or otherwise. Any license under such intellectual property rights
 *     must be expressed and approved by McAfee in writing.
 *
 */
@import url(https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;1,300;1,400;1,500;1,600;1,700;1,800&family=Poppins:ital,wght@0,400;0,500;0,600;0,800;1,400;1,500;1,600;1,800&display=swap);
*{border:0;box-sizing:border-box;font:inherit;font-family:"mcafeeOpenSans","Poppins",Helvetica,Arial,Arial,Helvetica,sans-serif;font-size:100%;margin:0;padding:0;vertical-align:baseline;outline:none}article,aside,details,figcaption,figure,footer,header,hgroup,menu,nav,section{display:block}html,body{background-color:#f5f6fa;font-family:"Poppins",Helvetica,Arial,"mcafeeOpenSans",Arial,Helvetica,sans-serif;line-height:1;height:100%;width:100%}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:after,blockquote:before,q:after,q:before{content:"";content:none}table{border-collapse:collapse;border-spacing:0}b{font-weight:bold}img{display:block}.dls__container{align-items:center;display:flex;margin:0 auto;margin-top:50px;position:relative}.dls__popup__expanded{align-items:center;overflow:hidden;border-radius:100px;cursor:pointer;display:flex;left:0;padding:15px;position:absolute;height:95px;width:383px;background-color:#fff;transition:all .3s ease-in-out}.dls__popup__expanded .dls__icon{height:65px;width:73px}.content{margin-left:12px}.content .content__images{display:flex;align-items:center;width:250px}.content .content__images .seperator__line{margin-left:5px;margin-right:10px}.content .content__images #dls_close_icon{cursor:pointer;margin-left:auto;margin-right:0px}.content p{font-family:"Poppins",Arial,Helvetica,sans-serif;font-weight:"400";font-size:14px;line-height:20px;margin-top:8px;color:#4258ff;width:250px;cursor:pointer}.shield{overflow:hidden;box-shadow:0px 2px 4px 0px rgba(33,41,52,.12),0px -1px 2px 0px rgba(0,0,0,.08);align-items:center;border-radius:100px;bottom:0;display:flex;height:95px;justify-content:center;position:absolute;right:0;width:383px;transition:all .3s ease-in-out}.shield__circle{display:flex;justify-content:center;align-items:center;width:55px;height:55px;background-color:#c01818;transition:all .6s ease-in-out .2s;z-index:1;opacity:0}

/*# sourceMappingURL=../sourceMap/chrome/css/download_scan_popup.css.map*/</style><div class="dls__container">
  <div class="shield" style="background: transparent; opacity: 0.1; display: none;">
    <div class="shield__circle" style="opacity: 1;">
      <img src="chrome-extension://fheoggkfdfchfphceeifdbepaooicaho/images/download_scan/mcafee_logo_white.svg?secret=rlsxv5" x-mcsrc="" id="dls_ballon_icon" x-mcsrcparsed="true">
    </div>
    <div class="dls__popup__expanded" style="opacity: 0;">
      <img src="chrome-extension://fheoggkfdfchfphceeifdbepaooicaho/images/download_scan/download_scan_icon.svg?secret=rlsxv5" x-mcsrc="" class="dls__icon" x-mcsrcparsed="true">
      <div class="content">
        <div class="content__images">
          <img src="chrome-extension://fheoggkfdfchfphceeifdbepaooicaho/images/download_scan/mcafee_logo_red.svg?secret=rlsxv5" x-mcsrc="" id="dls_mcafee_logo" x-mcsrcparsed="true">
          <img src="chrome-extension://fheoggkfdfchfphceeifdbepaooicaho/images/download_scan/seperator_line.svg?secret=rlsxv5" x-mcsrc="" class="seperator__line" x-mcsrcparsed="true">
          <img src="chrome-extension://fheoggkfdfchfphceeifdbepaooicaho/images/download_scan/webadvisor.svg?secret=rlsxv5" x-mcsrc="" x-mcsrcparsed="true">
          <img src="chrome-extension://fheoggkfdfchfphceeifdbepaooicaho/images/download_scan/close-outline.svg?secret=rlsxv5" x-mcsrc="" id="dls_close_icon" x-mcsrcparsed="true">
        </div>
        <p id="download_scan_popup_expanded_descriptions">Your download's being scanned. We'll let you know if there's an issue.</p>
      </div>
    </div>
  </div>
</div><style>/*!
 * 
 *     MCAFEE RESTRICTED CONFIDENTIAL
 *     Copyright (c) 2024 McAfee, LLC
 *
 *     The source code contained or described herein and all documents related
 *     to the source code ("Material") are owned by McAfee or its
 *     suppliers or licensors. Title to the Material remains with McAfee
 *     or its suppliers and licensors. The Material contains trade
 *     secrets and proprietary and confidential information of McAfee or its
 *     suppliers and licensors. The Material is protected by worldwide copyright
 *     and trade secret laws and treaty provisions. No part of the Material may
 *     be used, copied, reproduced, modified, published, uploaded, posted,
 *     transmitted, distributed, or disclosed in any way without McAfee's prior
 *     express written permission.
 *
 *     No license under any patent, copyright, trade secret or other intellectual
 *     property right is granted to or conferred upon you by disclosure or
 *     delivery of the Materials, either expressly, by implication, inducement,
 *     estoppel or otherwise. Any license under such intellectual property rights
 *     must be expressed and approved by McAfee in writing.
 *
 */
.mc-interactive-balloon{position:absolute;right:-50px;bottom:8px;box-shadow:rgba(0,0,0,.12) 0px 0px 10px;height:40px;width:40px;background:#1671ee;border-radius:20px;display:flex;justify-content:center;align-items:center}

/*# sourceMappingURL=../sourceMap/chrome/css/interactive_balloon.css.map*/</style></template></div></body></html>